!!!
%html
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %title= @page_title
    = csrf_meta_tags
    = stylesheet_link_tag    "application"
    = javascript_include_tag "https://maps.google.com/maps/api/js?key=#{Rails.application.secrets.maps_key}"
    = javascript_include_tag 'application', "data-turbolinks-eval" => false
    = metamagic

    %meta{:content => "width=device-width, initial-scale=1", :name => "viewport"}/
    = favicon_link_tag 'favicon.ico'
    - if Rails.env.production?
      / Piwik
      :javascript
        var _paq = _paq || [];
        /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
          var u="https://piwik.thomaskuhnert.com/";
          _paq.push(['setTrackerUrl', u+'piwik.php']);
          _paq.push(['setSiteId', '10']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        })();
      %noscript
        %p
          %img{:alt => "", :src => "https://piwik.thomaskuhnert.com/piwik.php?idsite=10&rec=1", :style => "border:0;"}/
      / End Piwik Code


  %body{class: class_for_controller, "data-spy" => "scroll", "data-target" => "#collapsingNavbarv"}
    - if controller.controller_name == "welcome" && @slides.any?
      .parallax

            
        #carouselExampleIndicators.h-100.carousel.slide{"data-ride" => "carousel"}
          - if @slides.length > 1
            %ol.carousel-indicators
              - @slides.each_with_index do |slide, index|
                %li{class: index == 0 ? "active" : "", "data-slide-to" => "1", "data-target" => "#carouselExampleIndicators"}
          .carousel-inner.h-100
            - @slides.each_with_index do |slide, index|
              .carousel-item.h-100{class: index == 0 ? "active" : ""}
                -#= image_tag slide.image(:original), class: 'd-block w-100'

                .fixed-ratio-md.card-header.p-0.overflow-hidden.h-100
                  .z-index-foreground-3.h-100.fixed-ratio__inner
                    - if slide.link?
                      = link_to "http://#{slide.link.sub(/^https?\:\/\//, '')}", class: "", target: "_blank" do
                        = image_set_tag slide.image(:thumbnail), {  slide.image(:thumbnail) => '640w',  slide.image(:original) => '1024w' }, sizes: '100vw', class: 'w-100 h-100 object-fit_cover'
                    - else 
                      = image_set_tag slide.image(:thumbnail), {  slide.image(:thumbnail) => '640w',  slide.image(:original) => '1024w' }, sizes: '100vw', class: 'w-100 h-100 object-fit_cover'
                .carousel-caption.d-none.d-md-block.text-white
                  %h5= slide.title
                  %p= excerpt(slide.caption, 'an', :radius => 100)


            - if @slides.length > 1
              %a.carousel-control-prev{"data-slide" => "prev", :href => "#carouselExampleIndicators", :role => "button"}
                %span.carousel-control-prev-icon{"aria-hidden" => "true"}
                %span.sr-only Previous
              %a.carousel-control-next{"data-slide" => "next", :href => "#carouselExampleIndicators", :role => "button"}
                %span.carousel-control-next-icon{"aria-hidden" => "true"}
                %span.sr-only Next



    = render "shared/navigation"


    #flashes
      = render "shared/flash", flashes: flash

    #content.bg-white
      = yield
    = render "shared/footer"

  = javascript_include_tag 'frontend.js', "data-turbolinks-eval" => false
